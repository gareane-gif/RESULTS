<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐ ูุงูุจ Excel ุงูุงุญุชุฑุงูู - ุงููุนูุฏ ุงูุนุงูู ููุนููู ูุงูุชูููุฉ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            direction: rtl;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section h2::before {
            content: '๐';
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 30px 0;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #333;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 15px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        
        th {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e3f2fd;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-right: 4px solid #2196f3;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-right: 4px solid #ff9800;
        }
        
        .success-box {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-right: 4px solid #4caf50;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .feature-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .footer {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
            margin-top: 40px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">๐</div>
                <h1>๐ ูุงูุจ Excel ุงูุงุญุชุฑุงูู</h1>
                <p>ุงููุนูุฏ ุงูุนุงูู ููุนููู ูุงูุชูููุฉ ุงูุฌูุฑุฉ ุจุณูููุฉ</p>
                <p style="margin-top: 10px; font-size: 0.9em;">ูุชูุงูู ูุน ุฌููุน ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ ูู ุงูููุธููุฉ</p>
            </div>
        </div>

        <div class="content">
            <div class="section">
                <h2>ูููุฒุงุช ุงููุงูุจ ุงูุฌุฏูุฏ</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>๐ฏ ุงูุชูุงูู ุงููุงูู</h3>
                        <p>ูุชูุงูู ูุน ุฌููุน ุงูุชุบููุฑุงุช ุงูุฌุฏูุฏุฉ ูู ุงูููุธููุฉ ุจูุง ูู ุฐูู ุงูุฃูุณุงู ุงูุฌุฏูุฏุฉ ูุงููุชุงุฆุฌ ุงููุญุฏุซุฉ</p>
                    </div>
                    <div class="feature-card">
                        <h3>๐ ุจูุงูุงุช ุดุงููุฉ</h3>
                        <p>ูุญุชูู ุนูู ุฌููุน ุงูุญููู ุงููุทููุจุฉ: ุงูุฑูู ุงูุฏุฑุงุณูุ ุงุณู ุงูุทุงูุจุ ุงููุณูุ ุงููุตูุ ุงูููุงุฏุ ุงูุฏุฑุฌุงุชุ GPAุ ุงูุญุงูุฉ</p>
                    </div>
                    <div class="feature-card">
                        <h3>๐ง ุตูุงูุฉ ุณููุฉ</h3>
                        <p>ุชุตููู ุงุญุชุฑุงูู ูุณูู ุงูุชุนุฏูู ูุงูุฅุถุงูุฉ ูุน ุฏุนู ุงูุฃูุณุงู ุงูุฌุฏูุฏุฉ ูุงูููุงุฏ ุงููุฎุตุตุฉ</p>
                    </div>
                    <div class="feature-card">
                        <h3>๐ ุฅุญุตุงุฆูุงุช ุฏูููุฉ</h3>
                        <p>ูุฏุนู ุญุณุงุจ GPA ูุงููุชุงุฆุฌ ุญุณุจ ุงูููุทู ุงูุฃูุงุฏููู ุงูุฌุฏูุฏ (ููููู/ุฑุงุณุจ)</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ุงูุญููู ุงููุชููุฑุฉ ูู ุงููุงูุจ</h2>
                <div class="info-box">
                    <h3>๐ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ:</h3>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>ุงูุฑูู ุงูุฏุฑุงุณู (ูุซุงู: SE242001)</li>
                        <li>ุงุณู ุงูุทุงูุจ ุงููุงูู</li>
                        <li>ุงููุณู (ูุฏุนู ุงูุฃูุณุงู ุงูุฌุฏูุฏุฉ)</li>
                        <li>ุงููุตู ุงูุฏุฑุงุณู (1-6)</li>
                        <li>ุชุงุฑูุฎ ุงูุฅุถุงูุฉ</li>
                    </ul>
                </div>
                
                <div class="warning-box">
                    <h3>๐ ุจูุงูุงุช ุงูููุงุฏ:</h3>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>ุงุณู ุงููุงุฏุฉ</li>
                        <li>ุงููุญุฏุงุช (1-6)</li>
                        <li>ุฃุนูุงู ุงููุตู (0-40)</li>
                        <li>ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู (0-60)</li>
                        <li>ุงููุฌููุน (ูุญุณุจ ุชููุงุฆูุงู)</li>
                        <li>ุงูุชูุฏูุฑ (ูุญุณุจ ุชููุงุฆูุงู)</li>
                    </ul>
                </div>
                
                <div class="success-box">
                    <h3>๐ ุงููุชุงุฆุฌ ูุงูุฅุญุตุงุฆูุงุช:</h3>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>GPA ุงููุตูู</li>
                        <li>ุญุงูุฉ ุงููุตู (ููููู/ุฑุงุณุจ)</li>
                        <li>ุนุฏุฏ ุงูููุงุฏ ุงููุงุฌุญุฉ</li>
                        <li>ุนุฏุฏ ุงูููุงุฏ ุงูุฑุงุณุจุฉ</li>
                        <li>ุงูุชูุฏูุฑ ุงูุนุงู</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>ูุนุงููุฉ ุงููุงูุจ</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ุงูุฑูู ุงูุฏุฑุงุณู</th>
                                <th>ุงุณู ุงูุทุงูุจ</th>
                                <th>ุงููุณู</th>
                                <th>ุงููุตู</th>
                                <th>ุงููุงุฏุฉ</th>
                                <th>ุงููุญุฏุงุช</th>
                                <th>ุฃุนูุงู ุงููุตู</th>
                                <th>ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู</th>
                                <th>ุงููุฌููุน</th>
                                <th>ุงูุชูุฏูุฑ</th>
                                <th>GPA</th>
                                <th>ุงูุญุงูุฉ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SE242001</td>
                                <td>ุฃุญูุฏ ูุญูุฏ ุนูู</td>
                                <td>ุงููุณุงุญุฉ</td>
                                <td>1</td>
                                <td>ุฑูุงุถูุงุช ููุฏุณูุฉ</td>
                                <td>3</td>
                                <td>20</td>
                                <td>30</td>
                                <td>75</td>
                                <td>ุฌูุฏ</td>
                                <td>75.00</td>
                                <td>ููููู</td>
                            </tr>
                            <tr>
                                <td>SE242001</td>
                                <td>ุฃุญูุฏ ูุญูุฏ ุนูู</td>
                                <td>ุงููุณุงุญุฉ</td>
                                <td>1</td>
                                <td>ููุฒูุงุก ููุฏุณูุฉ</td>
                                <td>3</td>
                                <td>18</td>
                                <td>32</td>
                                <td>85</td>
                                <td>ุฌูุฏ ุฌุฏุง</td>
                                <td>75.00</td>
                                <td>ููููู</td>
                            </tr>
                            <tr>
                                <td>CO242002</td>
                                <td>ูุญูุฏ ุฎุงูุฏ ุฃุญูุฏ</td>
                                <td>ุงูุญุงุณูุจ</td>
                                <td>2</td>
                                <td>ุจุฑูุฌุฉ 1</td>
                                <td>4</td>
                                <td>22</td>
                                <td>38</td>
                                <td>65</td>
                                <td>ููุจูู</td>
                                <td>65.00</td>
                                <td>ููููู</td>
                            </tr>
                            <tr>
                                <td>CS242003</td>
                                <td>ูุงุทูุฉ ุณุงูู ูุญูุฏ</td>
                                <td>ููุฏุณุฉ ุงูุจุฑูุฌูุงุช</td>
                                <td>1</td>
                                <td>ูุจุงุฏุฆ ุงูุจุฑูุฌุฉ</td>
                                <td>3</td>
                                <td>15</td>
                                <td>25</td>
                                <td>45</td>
                                <td>ุถุนูู</td>
                                <td>45.00</td>
                                <td>ุฑุงุณุจ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>ุฅูุดุงุก ุงูููุงูุจ</h2>
                <div class="button-group">
                    <button onclick="createFullTemplate()" class="btn btn-primary">
                        ๐ฅ ุฅูุดุงุก ูุงูุจ ูุงูู (ูุน ุจูุงูุงุช ุชุฌุฑูุจูุฉ)
                    </button>
                    <button onclick="createEmptyTemplate()" class="btn btn-secondary">
                        ๐ ุฅูุดุงุก ูุงูุจ ูุงุฑุบ
                    </button>
                    <button onclick="createDepartmentTemplate()" class="btn btn-warning">
                        ๐ข ุฅูุดุงุก ูุงูุจ ุญุณุจ ุงูุฃูุณุงู
                    </button>
                    <button onclick="createStatisticsTemplate()" class="btn btn-danger">
                        ๐ ุฅูุดุงุก ูุงูุจ ุงูุฅุญุตุงุฆูุงุช
                    </button>
                </div>
            </div>

            <div class="section">
                <h2>ุฅุญุตุงุฆูุงุช ุงููุงูุจ</h2>
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number">12+</div>
                        <div class="stat-label">ูุณู ูุฏุนูู</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">6</div>
                        <div class="stat-label">ูุตู ุฏุฑุงุณู</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">13</div>
                        <div class="stat-label">ุญูู ุจูุงูุงุช</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">ุชูุงูู ูุน ุงูููุธููุฉ</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ููููุฉ ุงูุงุณุชุฎุฏุงู</h2>
                <div class="info-box">
                    <h3>๐ ุฎุทูุงุช ุงูุงุณุชูุฑุงุฏ:</h3>
                    <ol style="margin-right: 20px; line-height: 2;">
                        <li>ุงุถุบุท ุนูู "ุฅูุดุงุก ูุงูุจ Excel" ูุชุญููู ุงูููู</li>
                        <li>ุงูุชุญ ุงูููู ูู ุจุฑูุงูุฌ Excel</li>
                        <li>ุงููุฃ ุจูุงูุงุช ุงูุทูุงุจ ูุงูููุงุฏ</li>
                        <li>ุงุญูุธ ุงูููู ุจุตูุบุฉ .xlsx</li>
                        <li>ุงูุชุญ ููุธููุฉ ุงูุทูุงุจ</li>
                        <li>ุงุฐูุจ ุฅูู ุชุจ "ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ Excel"</li>
                        <li>ุงุถุบุท "ุงุณุชูุฑุงุฏ ูู Excel" ูุงุฎุชุฑ ุงูููู</li>
                        <li>ุดุงูุฏ ุงููุชุงุฆุฌ ูู ุชุจ "ูุงุฆูุฉ ุงูุทูุงุจ"</li>
                    </ol>
                </div>
                
                <div class="warning-box">
                    <h3>โ๏ธ ููุงุญุธุงุช ูุงูุฉ:</h3>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>ุชุฃูุฏ ูู ุตุญุฉ ุงูุฑูู ุงูุฏุฑุงุณู (ูุซุงู: SE242001)</li>
                        <li>ุงุณู ุงููุณู ูุฌุจ ุฃู ูุทุงุจู ุงูุฃูุณุงู ุงูููุฌูุฏุฉ ูู ุงูููุธููุฉ</li>
                        <li>ุงููุญุฏุงุช ูุฌุจ ุฃู ุชููู ุจูู 1 ู 6</li>
                        <li>ุฃุนูุงู ุงููุตู ุงูุฃูุตู 40 ุฏุฑุฌุฉ</li>
                        <li>ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู ุงูุฃูุตู 60 ุฏุฑุฌุฉ</li>
                        <li>ุงููุฌููุน ูุญุณุจ ุชููุงุฆูุงู (ูุง ุชูู ุจุชุนุฏููู)</li>
                        <li>ุงูุชูุฏูุฑ ูุญุณุจ ุชููุงุฆูุงู (ูุง ุชูู ุจุชุนุฏููู)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>ยฉ 2026 ุงููุนูุฏ ุงูุนุงูู ููุนููู ูุงูุชูููุฉ ุงูุฌูุฑุฉ ุจุณูููุฉ</p>
            <p>ูุธุงู ุฅุฏุงุฑุฉ ุงูุทูุงุจ ุงููุชูุฏู - ุงูุฅุตุฏุงุฑ 2.0</p>
        </div>
    </div>

    <script>
        // Department data with all departments including new ones
        const departments = [
            'ุงูุชูููู ูุงููุตุงุฑู', 'ุงููุณุงุญุฉ', 'ุงูุญุงุณูุจ', 'ุงูุทุงูุฉ', 'ุงูููุฑุจุงุก', 'ุงููููุงูููุง'
        ];

        // Sample students data
        const sampleStudents = [
            {
                id: 'SE242001',
                name: 'ุฃุญูุฏ ูุญูุฏ ุนูู',
                department: 'ุงููุณุงุญุฉ',
                semester: 1,
                subjects: [
                    { name: 'ุฑูุงุถูุงุช ููุฏุณูุฉ', units: 3, classWork: 20, finalExam: 30, total: 75, evaluation: 'ุฌูุฏ' },
                    { name: 'ููุฒูุงุก ููุฏุณูุฉ', units: 3, classWork: 18, finalExam: 32, total: 85, evaluation: 'ุฌูุฏ ุฌุฏุง' },
                    { name: 'ุฑุณู ููุฏุณู', units: 2, classWork: 25, finalExam: 25, total: 90, evaluation: 'ููุชุงุฒ' }
                ]
            },
            {
                id: 'CO242002',
                name: 'ูุญูุฏ ุฎุงูุฏ ุฃุญูุฏ',
                department: 'ุงูุญุงุณูุจ',
                semester: 2,
                subjects: [
                    { name: 'ุจุฑูุฌุฉ 1', units: 4, classWork: 22, finalExam: 38, total: 65, evaluation: 'ููุจูู' },
                    { name: 'ููุงูู ุจูุงูุงุช', units: 3, classWork: 30, finalExam: 35, total: 95, evaluation: 'ููุชุงุฒ' }
                ]
            },
            {
                id: 'CS242003',
                name: 'ูุงุทูุฉ ุณุงูู ูุญูุฏ',
                department: 'ููุฏุณุฉ ุงูุจุฑูุฌูุงุช',
                semester: 1,
                subjects: [
                    { name: 'ูุจุงุฏุฆ ุงูุจุฑูุฌุฉ', units: 3, classWork: 15, finalExam: 25, total: 45, evaluation: 'ุถุนูู' },
                    { name: 'ุฑูุงุถูุงุช ูุชูุทุนุฉ', units: 3, classWork: 20, finalExam: 20, total: 40, evaluation: 'ุฑุงุณุจ' },
                    { name: 'ููุทู ุงูุจุฑูุฌุฉ', units: 2, classWork: 18, finalExam: 22, total: 55, evaluation: 'ููุจูู' }
                ]
            }
        ];

        function createFullTemplate() {
            const wb = XLSX.utils.book_new();
            
            // Create comprehensive template data
            const templateData = [
                ['ุงูุฑูู ุงูุฏุฑุงุณู', 'ุงุณู ุงูุทุงูุจ', 'ุงููุณู', 'ุงููุตู', 'ุงููุงุฏุฉ', 'ุงููุญุฏุงุช', 'ุฃุนูุงู ุงููุตู', 'ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู', 'ุงููุฌููุน', 'ุงูุชูุฏูุฑ', 'GPA', 'ุงูุญุงูุฉ', 'ุชุงุฑูุฎ ุงูุฅุถุงูุฉ']
            ];

            sampleStudents.forEach(student => {
                const gpa = calculateGPA(student.subjects);
                const status = getStatus(student.subjects, gpa);
                
                student.subjects.forEach(subject => {
                    templateData.push([
                        student.id,
                        student.name,
                        student.department,
                        student.semester,
                        subject.name,
                        subject.units,
                        subject.classWork,
                        subject.finalExam,
                        subject.total,
                        subject.evaluation,
                        gpa,
                        status,
                        new Date().toLocaleString('ar-SA')
                    ]);
                });
            });

            const ws = XLSX.utils.aoa_to_sheet(templateData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 15 }, // ุงูุฑูู ุงูุฏุฑุงุณู
                { width: 20 }, // ุงุณู ุงูุทุงูุจ
                { width: 15 }, // ุงููุณู
                { width: 10 }, // ุงููุตู
                { width: 20 }, // ุงููุงุฏุฉ
                { width: 10 }, // ุงููุญุฏุงุช
                { width: 12 }, // ุฃุนูุงู ุงููุตู
                { width: 15 }, // ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู
                { width: 10 }, // ุงููุฌููุน
                { width: 10 }, // ุงูุชูุฏูุฑ
                { width: 10 }, // GPA
                { width: 10 }, // ุงูุญุงูุฉ
                { width: 20 }  // ุชุงุฑูุฎ ุงูุฅุถุงูุฉ
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'ุจูุงูุงุช ุงูุทูุงุจ ุงููุงููุฉ');
            XLSX.writeFile(wb, `students_full_template_${new Date().toISOString().split('T')[0]}.xlsx`);
            
            alert('โ ุชู ุฅูุดุงุก ุงููุงูุจ ุงููุงูู ุจูุฌุงุญ!\n\nุงููุงูุจ ูุญุชูู ุนูู ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูู 3 ุทูุงุจ ูุน ุฌููุน ุงูุญููู ุงููุทููุจุฉ.');
        }

        function createEmptyTemplate() {
            const wb = XLSX.utils.book_new();
            
            const emptyTemplateData = [
                ['ุงูุฑูู ุงูุฏุฑุงุณู', 'ุงุณู ุงูุทุงูุจ', 'ุงููุณู', 'ุงููุตู', 'ุงููุงุฏุฉ', 'ุงููุญุฏุงุช', 'ุฃุนูุงู ุงููุตู', 'ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู', 'ุงููุฌููุน', 'ุงูุชูุฏูุฑ', 'GPA', 'ุงูุญุงูุฉ', 'ุชุงุฑูุฎ ุงูุฅุถุงูุฉ'],
                ['SE242001', 'ุฃุญูุฏ ูุญูุฏ ุนูู', 'ุงููุณุงุญุฉ', '1', 'ุฑูุงุถูุงุช ููุฏุณูุฉ', '3', '20', '30', '', '', '', '', '']
            ];

            const ws = XLSX.utils.aoa_to_sheet(emptyTemplateData);
            
            ws['!cols'] = [
                { width: 15 }, { width: 20 }, { width: 15 }, { width: 10 }, { width: 20 },
                { width: 10 }, { width: 12 }, { width: 15 }, { width: 10 }, { width: 10 },
                { width: 10 }, { width: 10 }, { width: 20 }
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'ูุงูุจ ูุงุฑุบ');
            XLSX.writeFile(wb, 'students_empty_template.xlsx');
            
            alert('โ ุชู ุฅูุดุงุก ุงููุงูุจ ุงููุงุฑุบ ุจูุฌุงุญ!\n\nููููู ุชุนุจุฆุฉ ุงูุจูุงูุงุช ูุฏููุงู ุซู ุงุณุชูุฑุงุฏูุง ูู ุงูููุธููุฉ.');
        }

        function createDepartmentTemplate() {
            const wb = XLSX.utils.book_new();
            
            departments.forEach(dept => {
                const deptData = [
                    ['ุงูุฑูู ุงูุฏุฑุงุณู', 'ุงุณู ุงูุทุงูุจ', 'ุงููุณู', 'ุงููุตู', 'ุงููุงุฏุฉ', 'ุงููุญุฏุงุช', 'ุฃุนูุงู ุงููุตู', 'ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู', 'ุงููุฌููุน', 'ุงูุชูุฏูุฑ'],
                    [`${dept.substring(0,2).toUpperCase()}242001`, 'ุงุณู ุงูุทุงูุจ', dept, '1', 'ุงููุงุฏุฉ 1', '3', '', '', '', ''],
                    [`${dept.substring(0,2).toUpperCase()}242001`, 'ุงุณู ุงูุทุงูุจ', dept, '1', 'ุงููุงุฏุฉ 2', '2', '', '', '', '']
                ];
                
                const ws = XLSX.utils.aoa_to_sheet(deptData);
                ws['!cols'] = [
                    { width: 15 }, { width: 20 }, { width: 15 }, { width: 10 }, { width: 20 },
                    { width: 10 }, { width: 12 }, { width: 15 }, { width: 10 }, { width: 10 }
                ];
                
                XLSX.utils.book_append_sheet(wb, ws, dept);
            });
            
            XLSX.writeFile(wb, 'students_by_departments.xlsx');
            alert('โ ุชู ุฅูุดุงุก ูุงูุจ ุงูุฃูุณุงู ุจูุฌุงุญ!\n\nูู ูุณู ูู ูุฑูุฉ ุนูู ูููุตูุฉ.');
        }

        function createStatisticsTemplate() {
            const wb = XLSX.utils.book_new();
            
            const statsData = [
                ['ุงููุณู', 'ุฅุฌูุงูู ุงูุทูุงุจ', 'ุงููุงุฌุญูู', 'ุงูุฑุงุณุจูู', 'ูุณุจุฉ ุงููุฌุงุญ', 'ูุนุฏู GPA'],
                ['ุงููุณุงุญุฉ', '45', '38', '7', '84.4%', '72.5'],
                ['ุงูุญุงุณูุจ', '52', '41', '11', '78.8%', '68.3'],
                ['ุงูุชูููู ูุงููุตุงุฑู', '38', '35', '3', '92.1%', '75.2'],
                ['ุงูุทุงูุฉ', '28', '22', '6', '78.6%', '70.1'],
                ['ุงูููุฑุจุงุก', '33', '28', '5', '84.8%', '71.8'],
                ['ุงููููุงูููุง', '41', '34', '7', '82.9%', '69.7']
            ];

            const ws = XLSX.utils.aoa_to_sheet(statsData);
            ws['!cols'] = [
                { width: 20 }, { width: 15 }, { width: 12 }, { width: 12 }, { width: 15 }, { width: 12 }
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'ุฅุญุตุงุฆูุงุช ุงูุฃูุณุงู');
            XLSX.writeFile(wb, 'departments_statistics.xlsx');
            
            alert('โ ุชู ุฅูุดุงุก ูุงูุจ ุงูุฅุญุตุงุฆูุงุช ุจูุฌุงุญ!\n\nูุญุชูู ุนูู ุฅุญุตุงุฆูุงุช ุชุฌุฑูุจูุฉ ูุฌููุน ุงูุฃูุณุงู.');
        }

        function calculateGPA(subjects) {
            if (!subjects || subjects.length === 0) return 0;
            
            let totalUnits = 0;
            let totalWeightedGrade = 0;
            
            subjects.forEach(subject => {
                if (subject.total && subject.units) {
                    totalUnits += subject.units;
                    totalWeightedGrade += (subject.total * subject.units);
                }
            });
            
            return totalUnits > 0 ? (totalWeightedGrade / totalUnits).toFixed(2) : 0;
        }

        function getStatus(subjects, gpa) {
            if (!subjects || subjects.length === 0) return 'ุบูุฑ ูุญุฏุฏ';
            
            const failedSubjects = subjects.filter(s => s.total < 50).length;
            return failedSubjects <= 2 && parseFloat(gpa) >= 50 ? 'ููููู' : 'ุฑุงุณุจ';
        }

        // Auto-info on page load
        window.onload = function() {
            console.log('๐ ุตูุญุฉ ูุงูุจ Excel ุงูุงุญุชุฑุงูู ุฌุงูุฒุฉ');
            console.log('๐ ูุชูุงูู ูุน ููุธููุฉ ุงูุทูุงุจ ุงูุฅุตุฏุงุฑ 2.0');
        };
    </script>
</body>
</html>
