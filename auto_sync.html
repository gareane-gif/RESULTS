<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #4CAF50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .sync-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sync-panel h3 {
            color: #4CAF50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #f44336, #da190b);
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #ff9800, #e68900);
        }
        
        .btn-info {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }
        
        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }
        
        .status.success {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid #4CAF50;
            color: #4CAF50;
        }
        
        .status.error {
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid #f44336;
            color: #f44336;
        }
        
        .status.info {
            background: rgba(33, 150, 243, 0.2);
            border: 2px solid #2196F3;
            color: #2196F3;
        }
        
        .status.warning {
            background: rgba(255, 152, 0, 0.2);
            border: 2px solid #ff9800;
            color: #ff9800;
        }
        
        .data-display {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .sync-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .method-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .method-card h4 {
            color: #4CAF50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .method-card p {
            color: #ccc;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .auto-sync-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }
        
        .auto-sync-indicator.active {
            background: #4CAF50;
        }
        
        .auto-sync-indicator.inactive {
            background: #f44336;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .stat-label {
            color: #ccc;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø°ÙƒÙŠØ©</h1>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="studentCount">0</div>
                <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="syncStatus">ğŸ”´</div>
                <div class="stat-label">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="lastSync">Ù„Ù… ÙŠØªÙ…</div>
                <div class="stat-label">Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="connectionStatus">ğŸ”´</div>
                <div class="stat-label">Ø§Ù„Ø§ØªØµØ§Ù„</div>
            </div>
        </div>
        
        <div class="sync-panel">
            <h3>ğŸš€ Ù…Ø²Ø§Ù…Ù†Ø© ÙÙˆØ±ÙŠØ©</h3>
            <button class="btn btn-success" onclick="startAutoSync()">
                ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
                <span class="auto-sync-indicator inactive" id="syncIndicator"></span>
            </button>
            <button class="btn btn-warning" onclick="stopAutoSync()">
                â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
            </button>
            <button class="btn btn-info" onclick="forceSyncNow()">
                âš¡ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¢Ù†
            </button>
            <button class="btn btn-danger" onclick="clearAllData()">
                ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <div id="syncStatusMessage"></div>
        </div>
        
        <div class="sync-methods">
            <div class="method-card">
                <h4>ğŸŒ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</h4>
                <p>Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø± Firebase Ø¹Ù†Ø¯ ØªÙˆÙØ± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>
                <button class="btn btn-info" onclick="enableFirebaseSync()">
                    ğŸ”¥ ØªÙØ¹ÙŠÙ„ Firebase
                </button>
            </div>
            
            <div class="method-card">
                <h4>ğŸ“± Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª</h4>
                <p>Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø± localStorage ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©</p>
                <button class="btn btn-success" onclick="enableOfflineSync()">
                    ğŸ“± ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª
                </button>
            </div>
            
            <div class="method-card">
                <h4>ğŸ”— Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¹Ø¨Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h4>
                <p>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø± Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© ÙˆØ£ÙƒÙˆØ§Ø¯</p>
                <button class="btn btn-warning" onclick="generateShareLink()">
                    ğŸ”— Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ©
                </button>
            </div>
            
            <div class="method-card">
                <h4>ğŸ“¤ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¹Ø¨Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</h4>
                <p>ØªØµØ¯ÙŠØ± ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø± Ù…Ù„ÙØ§Øª JSON</p>
                <button class="btn btn-info" onclick="exportToFile()">
                    ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-success" onclick="importFromFile()">
                    ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
        </div>
        
        <div class="sync-panel">
            <h3>ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
            <button class="btn btn-info" onclick="showCurrentData()">
                ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <div id="dataDisplay" class="data-display" style="display: none;"></div>
        </div>
    </div>

    <script>
        let autoSyncInterval;
        let isAutoSyncing = false;
        
        // Initialize
        window.onload = function() {
            updateStats();
            checkConnectionStatus();
            setupEventListeners();
        };
        
        // Setup event listeners
        function setupEventListeners() {
            // Listen for online/offline events
            window.addEventListener('online', function() {
                document.getElementById('connectionStatus').textContent = 'ğŸŸ¢';
                document.getElementById('syncStatus').textContent = 'ğŸŸ¡';
                showStatus('ğŸŒ ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª', 'success');
                
                // Try to sync if auto-sync is active
                if (isAutoSyncing) {
                    setTimeout(() => {
                        if (navigator.onLine) {
                            syncWithMainSystem();
                        }
                    }, 2000);
                }
            });
            
            window.addEventListener('offline', function() {
                document.getElementById('connectionStatus').textContent = 'ğŸ”´';
                document.getElementById('syncStatus').textContent = 'ğŸ”´';
                showStatus('ğŸ“´ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª - Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª', 'warning');
            });
            
            // Listen for storage changes (from other tabs)
            window.addEventListener('storage', function(e) {
                if (e.key === 'students') {
                    updateStats();
                }
            });
        }
        
        // Update statistics
        function updateStats() {
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            document.getElementById('studentCount').textContent = students.length;
            
            const lastSyncTime = localStorage.getItem('lastSyncTime');
            if (lastSyncTime) {
                const date = new Date(parseInt(lastSyncTime));
                document.getElementById('lastSync').textContent = date.toLocaleTimeString('ar-EG');
            }
        }
        
        // Check connection status
        function checkConnectionStatus() {
            const status = navigator.onLine ? 'ğŸŸ¢' : 'ğŸ”´';
            document.getElementById('connectionStatus').textContent = status;
        }
        
        // Start auto sync
        function startAutoSync() {
            if (isAutoSyncing) {
                showStatus('Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ØªØ¹Ù…Ù„ Ø¨Ø§Ù„ÙØ¹Ù„', 'warning');
                return;
            }
            
            isAutoSyncing = true;
            document.getElementById('syncIndicator').className = 'auto-sync-indicator active';
            document.getElementById('syncStatus').textContent = 'ğŸŸ¡';
            
            showStatus('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©', 'success');
            
            // Sync every 30 seconds
            autoSyncInterval = setInterval(() => {
                if (navigator.onLine) {
                    syncWithMainSystem();
                } else {
                    console.log('â¸ï¸ Offline - skipping sync');
                }
            }, 30000);
            
            // Try immediate sync
            if (navigator.onLine) {
                setTimeout(() => syncWithMainSystem(), 1000);
            }
        }
        
        // Stop auto sync
        function stopAutoSync() {
            if (!isAutoSyncing) {
                showStatus('Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…ØªÙˆÙ‚ÙØ© Ø¨Ø§Ù„ÙØ¹Ù„', 'warning');
                return;
            }
            
            isAutoSyncing = false;
            document.getElementById('syncIndicator').className = 'auto-sync-indicator inactive';
            document.getElementById('syncStatus').textContent = 'ğŸ”´';
            
            if (autoSyncInterval) {
                clearInterval(autoSyncInterval);
            }
            
            showStatus('â¸ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©', 'warning');
        }
        
        // Force sync now
        function forceSyncNow() {
            showStatus('âš¡ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©...', 'info');
            
            if (navigator.onLine) {
                syncWithMainSystem();
            } else {
                syncOffline();
            }
        }
        
        // Sync with main system
        function syncWithMainSystem() {
            try {
                // Get current data
                const currentData = JSON.parse(localStorage.getItem('students') || '[]');
                
                // Store for main system
                localStorage.setItem('autoSyncData', JSON.stringify({
                    timestamp: Date.now(),
                    students: currentData,
                    source: 'auto_sync'
                }));
                
                // Update last sync time
                localStorage.setItem('lastSyncTime', Date.now().toString());
                
                // Update stats
                updateStats();
                
                showStatus(`âœ… ØªÙ… Ù…Ø²Ø§Ù…Ù†Ø© ${currentData.length} Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                document.getElementById('syncStatus').textContent = 'ğŸŸ¢';
                
                console.log('âœ… Auto sync completed:', currentData.length, 'students');
                
            } catch (error) {
                showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©: ' + error.message, 'error');
                console.error('Sync error:', error);
            }
        }
        
        // Offline sync
        function syncOffline() {
            try {
                const currentData = JSON.parse(localStorage.getItem('students') || '[]');
                
                // Store for offline sync
                localStorage.setItem('offlineSyncData', JSON.stringify({
                    timestamp: Date.now(),
                    students: currentData,
                    source: 'offline_sync'
                }));
                
                showStatus(`âœ… ØªÙ… Ø­ÙØ¸ ${currentData.length} Ø·Ø§Ù„Ø¨ Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª`, 'success');
                
            } catch (error) {
                showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ù„ÙŠ: ' + error.message, 'error');
            }
        }
        
        // Enable Firebase sync
        function enableFirebaseSync() {
            window.open('firebase_sync.html', '_blank');
            showStatus('ğŸ”¥ ØªÙ… ÙØªØ­ ØµÙØ­Ø© Firebase Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©', 'info');
        }
        
        // Enable offline sync
        function enableOfflineSync() {
            window.open('offline_sync.html', '_blank');
            showStatus('ğŸ“± ØªÙ… ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª', 'info');
        }
        
        // Generate share link
        function generateShareLink() {
            const data = JSON.parse(localStorage.getItem('students') || '[]');
            
            if (data.length === 0) {
                showStatus('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§', 'error');
                return;
            }
            
            // Create shareable link
            const encodedData = btoa(JSON.stringify(data));
            const shareUrl = `${window.location.origin}${window.location.pathname}?sync_data=${encodeURIComponent(encodedData)}&t=${Date.now()}`;
            
            // Copy to clipboard
            navigator.clipboard.writeText(shareUrl).then(() => {
                showStatus('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'success');
            }).catch(() => {
                showStatus('âŒ ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'error');
            });
            
            console.log('Share link:', shareUrl);
        }
        
        // Export to file
        function exportToFile() {
            const data = JSON.parse(localStorage.getItem('students') || '[]');
            
            if (data.length === 0) {
                showStatus('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§', 'error');
                return;
            }
            
            const jsonStr = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `students_auto_sync_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus(`âœ… ØªÙ… ØªØµØ¯ÙŠØ± ${data.length} Ø·Ø§Ù„Ø¨`, 'success');
        }
        
        // Import from file
        function importFromFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (!Array.isArray(data)) {
                            throw new Error('Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„Ø·Ù„Ø§Ø¨');
                        }
                        
                        // Validate data
                        for (let i = 0; i < data.length; i++) {
                            const student = data[i];
                            if (!student.id || !student.name || !student.department || !student.semester) {
                                throw new Error(`Ø§Ù„Ø·Ø§Ù„Ø¨ Ø±Ù‚Ù… ${i+1} ØºÙŠØ± Ù…ÙƒØªÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`);
                            }
                        }
                        
                        // Save data
                        localStorage.setItem('students', JSON.stringify(data));
                        updateStats();
                        
                        showStatus(`âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${data.length} Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                        
                    } catch (error) {
                        showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù: ' + error.message, 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // Show current data
        function showCurrentData() {
            const data = JSON.parse(localStorage.getItem('students') || '[]');
            const display = document.getElementById('dataDisplay');
            
            if (data.length === 0) {
                display.innerHTML = '<div style="text-align: center; color: #ccc;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø§Ù„ÙŠØ©</div>';
                display.style.display = 'block';
                return;
            }
            
            let html = `<strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨: ${data.length}</strong><br><br>`;
            
            data.forEach((student, index) => {
                html += `
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 10px; margin: 5px 0; border-radius: 5px;">
                        <strong>${index + 1}. ${student.name}</strong><br>
                        <small style="color: #ccc;">
                            ${student.id} | ${student.department} | ${student.semester}
                            ${student.subjects ? `| ${student.subjects.length} Ù…ÙˆØ§Ø¯` : ''}
                        </small>
                    </div>
                `;
            });
            
            display.innerHTML = html;
            display.style.display = 'block';
        }
        
        // Clear all data
        function clearAllData() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                return;
            }
            
            localStorage.removeItem('students');
            localStorage.removeItem('autoSyncData');
            localStorage.removeItem('offlineSyncData');
            localStorage.removeItem('lastSyncTime');
            
            updateStats();
            showStatus('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'warning');
            
            if (document.getElementById('dataDisplay').style.display === 'block') {
                document.getElementById('dataDisplay').style.display = 'none';
            }
        }
        
        // Show status message
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('syncStatusMessage');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 5000);
        }
        
        // Check for sync data on load
        window.addEventListener('load', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const syncData = urlParams.get('sync_data');
            
            if (syncData) {
                try {
                    const data = JSON.parse(atob(syncData));
                    
                    if (Array.isArray(data) && data.length > 0) {
                        localStorage.setItem('students', JSON.stringify(data));
                        updateStats();
                        showStatus(`âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${data.length} Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´ØªØ±Ùƒ`, 'success');
                    }
                } catch (error) {
                    showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·', 'error');
                }
            }
        });
    </script>
</body>
</html>
